@model List<ApplicationUser>
@{
    ViewData["Title"] = "Friends";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="row">
    <div class="col-md-8">
        <div class="form-group">
            <h1 class="mt-2" for="inputDefault">Search friend</h1>
            <input type="text" class="form-control" placeholder="Default input" id="inputDefault">
        </div>
        <div id="friendSearchContainer"></div>
    </div>
    <div class="col-md-4">
        <div class="row">
            <div style="border: 2px solid gray; border-radius: 10px 10px 0 0; margin: 15px; margin-bottom: 0; text-align: center; vertical-align: middle; margin-top:64px;">
                <h1 style="margin: 30px 100px;">FRIEND LIST</h1>
            </div>
        </div>
        <div class="row">
            <div style="border: 2px solid gray; border-radius: 0 0 10px 10px; border-top: 0px; margin: 15px; margin-top: 0;">
                @{
                    @if (Model.Count > 0)
                    {
                        @foreach (var item in Model)
                        {
                            if(Model.Last() == item)
                            {
                                <div class="row friend-card" style="border-bottom: 0;">
                                    <a style="display:flex; text-decoration: none; gap: 10px;" class="col-md-8" asp-controller="Home" asp-action="UserProfile" asp-route-UserId="@item.Id">
                                        @if (@item.UserImage == null || @item.UserImage.Length == 0)
                                        {
                                            <div class="col-md-2" style="width: 40px; height: 40px; border-radius:50%; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIIAAACCCAMAAAC93eDPAAAATlBMVEV8fHz///95eXl2dnZzc3P7+/uHh4f39/fk5OS6urp/f3+3t7fc3Nz09PTX19enp6fDw8Pt7e3JycmPj4+YmJjR0dFubm6hoaGxsbFpaWk+hcYGAAADlElEQVR4nO2aa7qjMAiGFWJqrPf77H+jU+u0x1ptAyGe+eG7gXwPAUKAIDg5OTk5OTk5OfEJoOrvKAT4jeNRD9c6j6sqTjtTNIE6VgVCc42zcMGlKofkOFtgMMRR+E5lNB4iApNrtXH+bIu6Qe8CAIZ4T8BEZhLPhoCk3LqCJWnr1RCoP5rg320UyqOC4ZsJZmpvoYHFxUpBGHaBHw32CiY7+FAAjd0tzBgPPgl6NxtsUshrSHKSgjBrpe8CR5qCW34QlgBN9v3QFaNselAdWUGYiSoATVcgHBVYcyRUWk4BaPuktGSUMwNeWQrCNBGTAClPwkUsN3AicuYqdRP0tPQgl7KCYsXDRCXlDGhRKm0TNUJmSGhv5JJCRgI0vKwwIeSPtFrlFaEcDS1bQVifEiYJMjUDNHwJpZQ7/npEBMTaeYlQXgiAnR1DqaeSUzjOZFJ1E7diESzkoeX6o1BA3EiYzhANYt8ZVfIkxIK1I/OhMoJ/OiT+aWcyqYJlgvdMyPY5FKeM16ISON5QCjfegBwUYtXzU4JNx3FJJN/pwZZ2FaWHnhsWFAWdvIAbytgrSD01w9HaJWPZeFwAlq+2LxvcNRQ23/za60gC2q+xmY2eZyIYmM/BmR8wGlJNt19ExcUhs0KAttx0iUte+B5MLUQ0Y75SEcVl62kQsiMCQQ8mj+crqdKyaOCYGeVKhur/3Ol79RtD6/8CuJn+CR5/DajUzRnuk/tsmt3XYxv0B8rAXo/d23c7ik2DB6WFpMh3klNUGe09MgG0+dhuuHSt3+hAvZ0YX0hbf04BH1YXXuh8vVXYWn9ostGHS4C6UtoMuZYv4jXxayu+xmBRLr1hRC8DB07jrxQsH2zXN9Z0YhKw4I4DcqE0BYT1jTW1iD9Ay50RTkh8b6nrG2sEOuEJc1T7IBpcNXB7jj9Ujn9cHFwVuPYaIHFxxQdOSwTAnhUvyRyuAogNpj06hxfLMRqesFvB/K2BNeyePHcOsQFzTiZnBPZaS++WmV/gDWhcprTv5JzcAKw5yB6chQ6XtYUtGLMBJPR7bch6soRALiJnyDfBn4/uQV6nUOwp8R4x2QpSz8MP1DG+ligUXiFWkSBQLa0hbrzxFwb2IT6XyF6b2CciOoN0VpigzQ1FytY1hpKjeVvH3yCVkC4bXfuQVltAsGD6ISYoEH8mZ0iTdN769zdIXxofaeGWGEgSRIu2J5SS4VgJfwEtli8l0fhpQwAAAABJRU5ErkJggg=='); background-size: 100% 100%"></div>
                                        }
                                        else
                                        {
                                            <div class="col-md-2" style="width: 40px; height: 40px; border-radius:50%; background-image: url('data:image/png;base64,@Convert.ToBase64String(item.UserImage)'); background-size: 100% 100%"></div>
                                        }
                                        <p class="col-md-4 m-0 p-1">@item.Nickname</p>
                                    </a>
                                    <a class="btn btn-primary col-md-2" asp-controller="Home" asp-action="DeleteFriend" asp-route-FriendId="@item.Id">Delete</a>
                                </div>
                            }
                            else
                            {
                                <div class="row friend-card">
                                    <a style="display:flex; text-decoration: none; gap: 10px;" class="col-md-8" asp-controller="Home" asp-action="UserProfile" asp-route-UserId="@item.Id">
                                        @if (@item.UserImage == null || @item.UserImage.Length == 0)
                                        {
                                            <div class="col-md-2" style="width: 40px; height: 40px; border-radius:50%; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIIAAACCCAMAAAC93eDPAAAATlBMVEV8fHz///95eXl2dnZzc3P7+/uHh4f39/fk5OS6urp/f3+3t7fc3Nz09PTX19enp6fDw8Pt7e3JycmPj4+YmJjR0dFubm6hoaGxsbFpaWk+hcYGAAADlElEQVR4nO2aa7qjMAiGFWJqrPf77H+jU+u0x1ptAyGe+eG7gXwPAUKAIDg5OTk5OTk5OfEJoOrvKAT4jeNRD9c6j6sqTjtTNIE6VgVCc42zcMGlKofkOFtgMMRR+E5lNB4iApNrtXH+bIu6Qe8CAIZ4T8BEZhLPhoCk3LqCJWnr1RCoP5rg320UyqOC4ZsJZmpvoYHFxUpBGHaBHw32CiY7+FAAjd0tzBgPPgl6NxtsUshrSHKSgjBrpe8CR5qCW34QlgBN9v3QFaNselAdWUGYiSoATVcgHBVYcyRUWk4BaPuktGSUMwNeWQrCNBGTAClPwkUsN3AicuYqdRP0tPQgl7KCYsXDRCXlDGhRKm0TNUJmSGhv5JJCRgI0vKwwIeSPtFrlFaEcDS1bQVifEiYJMjUDNHwJpZQ7/npEBMTaeYlQXgiAnR1DqaeSUzjOZFJ1E7diESzkoeX6o1BA3EiYzhANYt8ZVfIkxIK1I/OhMoJ/OiT+aWcyqYJlgvdMyPY5FKeM16ISON5QCjfegBwUYtXzU4JNx3FJJN/pwZZ2FaWHnhsWFAWdvIAbytgrSD01w9HaJWPZeFwAlq+2LxvcNRQ23/za60gC2q+xmY2eZyIYmM/BmR8wGlJNt19ExcUhs0KAttx0iUte+B5MLUQ0Y75SEcVl62kQsiMCQQ8mj+crqdKyaOCYGeVKhur/3Ol79RtD6/8CuJn+CR5/DajUzRnuk/tsmt3XYxv0B8rAXo/d23c7ik2DB6WFpMh3klNUGe09MgG0+dhuuHSt3+hAvZ0YX0hbf04BH1YXXuh8vVXYWn9ostGHS4C6UtoMuZYv4jXxayu+xmBRLr1hRC8DB07jrxQsH2zXN9Z0YhKw4I4DcqE0BYT1jTW1iD9Ay50RTkh8b6nrG2sEOuEJc1T7IBpcNXB7jj9Ujn9cHFwVuPYaIHFxxQdOSwTAnhUvyRyuAogNpj06hxfLMRqesFvB/K2BNeyePHcOsQFzTiZnBPZaS++WmV/gDWhcprTv5JzcAKw5yB6chQ6XtYUtGLMBJPR7bch6soRALiJnyDfBn4/uQV6nUOwp8R4x2QpSz8MP1DG+ligUXiFWkSBQLa0hbrzxFwb2IT6XyF6b2CciOoN0VpigzQ1FytY1hpKjeVvH3yCVkC4bXfuQVltAsGD6ISYoEH8mZ0iTdN769zdIXxofaeGWGEgSRIu2J5SS4VgJfwEtli8l0fhpQwAAAABJRU5ErkJggg=='); background-size: 100% 100%"></div>
                                        }
                                        else
                                        {
                                            <div class="col-md-2" style="width: 40px; height: 40px; border-radius:50%; background-image: url('data:image/png;base64,@Convert.ToBase64String(item.UserImage)'); background-size: 100% 100%"></div>
                                        }
                                        <p class="col-md-4 m-0 p-1">@item.Nickname</p>
                                    </a>
                                    <a class="btn btn-primary col-md-2" asp-controller="Home" asp-action="DeleteFriend" asp-route-FriendId="@item.Id">Delete</a>
                                </div>
                            }
                        }
                    }
                    else
                    {
                        <h1 style="margin: 200px 50px;">No friends yet... :(</h1>
                    }
                }
            </div>
        </div>
    </div>
</div>

<script>
    const searchInput = document.getElementById('inputDefault');

    searchInput.addEventListener('input', function () {
        const query = this.value.trim();
        $.ajax({
            url: "/Home/PartialSearchFriend",
            type: "GET",
            data: {
                Search: query,
            },
            success: function (result) {
                $("#friendSearchContainer").html(result);
            },
        });
    });
</script>
